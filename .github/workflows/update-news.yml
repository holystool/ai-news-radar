name: Update News and Email

on:
  schedule:
    # æ¯å¤©åŒ—äº¬æ—¶é—´æ—©ä¸Š 8:00 è¿è¡Œ (UTC 0:00)
    - cron: '0 0 * * *'
  workflow_dispatch: # å…è®¸ä½ æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®æµ‹è¯•è¿è¡Œ

jobs:
  update:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Install dependencies
        run: |
          pip install -r requirements.txt

      - name: Run Scraper
        run: |
          python scripts/update_news.py --output-dir data --window-hours 24

      # å…³é”®æ­¥éª¤ï¼šå‘é€é‚®ä»¶
        - name: Send mail
        uses: dawidd6/action-send-mail@v3
        with:
          server_address: smtp.gmail.com # ä¿®æ”¹ä¸º Gmail çš„æœåŠ¡å™¨
          server_port: 465               # Gmail æ¨è 465 (SSL)
          username: ${{ holstoolai@hotmail.com }} # ä½ çš„ Gmail åœ°å€
          password: ${{ thid prnc yvgm oedj }} # å¡«åˆšæ‰é‚£ä¸² 16 ä½æˆæƒç 
          subject: "ğŸ“… ä»Šå¤©çš„ AI æ–°é—»æ—©æŠ¥å·²é€åˆ°ï¼"
          to: ä½ çš„æ¥æ”¶é‚®ç®±holystool@gmail.com
          from: AI News Radar
          attachments: data/*.json
